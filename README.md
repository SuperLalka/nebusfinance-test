<!-- PROJECT LOGO -->
<div align="center">
  <h2>nebusfinance-test</h2>

  <h3 align="center">README тестового задания</h3>

  <p align="center">
    FastApi-приложение: справочник Организаций, Зданий, Деятельности
  </p>
</div>

<a name="readme-top"></a>

<hr>

<!-- ABOUT THE PROJECT -->
## About The Project

Необходимо реализовать REST API приложение для справочника Организаций, Зданий, Деятельности.

### Функциональные требования:

#### Модели:
* Организация – Представляет собой карточку организации в справочнике и должна содержать в себе следующую информацию:
  - Название: Например ООО “Рога и Копыта”
  - Номер телефона: организация может иметь несколько номеров телефонов (2-222-222, 3-333-333, 8-923-666-13-13)
  - Здание: Организация должна находится в одном конкретном здании (Например, Блюхера, 32/1)
  - Деятельность: Организация может заниматься несколькими видами деятельностей (Например, “Молочная продукция”, “Мясная продукция”)

* Здание - Содержит в себе как минимум информацию о конкретном здании, а именно:
  - Адрес: Например - г. Москва, ул. Ленина 1, офис 3
  - Географические координаты: Местоположение здания должно быть в виде широты и долготы.

* Деятельность - позволяет классифицировать род деятельности организаций в каталоге. Имеет название и может в древовидном виде вкладываться друг в друга. Пример возможного дерева деятельности::
  - Еда
    - Мясная продукция
    - Молочная продукция
  - Автомобили
    - Грузовые
    - Легковые
        - Запчасти
        - Аксессуары

#### Функционал:
Взаимодействие с пользователем происходит посредством HTTP запросов к API серверу с использованием статического API ключа.
Все ответы должны быть в формате JSON. Необходимо реализовать следующие методы:

* список всех организаций находящихся в конкретном здании
* список всех организаций, которые относятся к указанному виду деятельности
* список организаций, которые находятся в заданном радиусе/прямоугольной области относительно указанной точки на карте. список зданий
* вывод информации об организации по её идентификатору 
* искать организации по виду деятельности. Например, поиск по виду деятельности «Еда», которая находится на первом уровне дерева,
и чтобы нашлись все организации, которые относятся к видам деятельности, лежащим внутри.
Т.е. в результатах поиска должны отобразиться организации с видом деятельности Еда, Мясная продукция, Молочная продукция.
* поиск организации по названию
* ограничить уровень вложенности деятельностей 3 уровням

#### Задание:
* Спроектировать БД + Создать необходимые миграции + Заполнить БД тестовыми данными
* Реализовать API согласно разделу Функционал приложения
* Завернуть приложения в Docker контейнер, чтобы его можно было развернуть на любой машине (Если необходимо, то написать инструкцию по разворачиванию)
* Добавить в проект документацию Swagger UI или Redoc с описанием всех методов приложения.
 
### Технические требования
* fastapi
* pydantic
* sqlalchemy
* alembic

### Built With

* [![FastApi][FastApi-badge]][FastApi-url]
* [![Postgres][Postgres-badge]][Postgres-url]
* [![SQLAlchemy][SQLAlchemy-badge]][SQLAlchemy-url]
* [![Docker][Docker-badge]][Docker-url]


<!-- GETTING STARTED -->
## Getting Started

### Prerequisites

Скопировать проект в репозиторий на локальной машине (HTTPS или SSH)
  ```sh
  git clone https://github.com/SuperLalka/nebusfinance-test.git
  ```
  ```sh
  git clone git@github.com:SuperLalka/nebusfinance-test.git
  ```

### Installation

Для запуска проекта достаточно собрать и запустить контейнеры Docker.
Миграция базы данных и загрузка фикстур будут применены автоматически.

```sh
docker-compose -f docker-compose.yml up -d --build
```

Запуск тестов:
```sh
docker-compose -f test.yml up --build
```

### Documentation

#### Примеры запросов:

- вывод информации об организации по её идентификатору
```http request
http://0.0.0.0/api/v1/organizations/d38caddb-6e36-4cac-afbd-aa2d74e8023a/
```

- поиск организации по названию
```http request
http://0.0.0.0/api/v1/organizations/?name=Минский
```

- список всех организаций находящихся в конкретном здании
```http request
http://0.0.0.0/api/v1/organizations/?building_id=1444a266-ee1f-4820-af5e-024b2120679a
```

- список всех организаций, которые относятся к указанному виду деятельности 
```http request
http://0.0.0.0/api/v1/organizations/?activity_id=6
```

- список всех организаций, которые относятся к указанной группе видов деятельности (включая подвиды вниз по дереву поиска)
```http request
http://0.0.0.0/api/v1/organizations/?activity_group=6
```

- список организаций, которые находятся в заданном радиусе относительно указанной точки на карте
```http request
http://0.0.0.0/api/v1/organizations/?within_radius_point=53.88974510260204,27.56195161073504&within_radius_distance=500
```

- список организаций, которые находятся в заданной прямоугольной области на карте
```http request
http://0.0.0.0/api/v1/organizations/?within_area_points=53.969592 27.429032,53.802464 27.415299,53.813843 27.711930,53.987401 27.720170,53.969592 27.429032
```

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- MARKDOWN LINKS & IMAGES -->
<!-- https://www.markdownguide.org/basic-syntax/#reference-style-links -->
[FastApi-badge]: https://img.shields.io/badge/fastapi-%23009688.svg?style=for-the-badge&logo=fastapi&logoColor=white
[FastApi-url]: https://fastapi.tiangolo.com/
[Postgres-badge]: https://img.shields.io/badge/postgresql-%234169E1.svg?style=for-the-badge&logo=postgresql&logoColor=white
[Postgres-url]: https://www.postgresql.org/
[SQLAlchemy-badge]: https://img.shields.io/badge/sqlalchemy-%23D71F00.svg?style=for-the-badge&logo=sqlalchemy&logoColor=white
[SQLAlchemy-url]: https://www.sqlalchemy.org/
[Docker-badge]: https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white
[Docker-url]: https://www.docker.com/
